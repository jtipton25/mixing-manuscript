---
bibliography: mixing.bib
citation_package: biblatex
output:
  pdf_document:
    dev: pdf
    fig_caption: yes
    keep_tex: yes
    number_section: yes
    template: myTemplate.tex
  word_document: default
pandoc_options: --biblatex
---



```{r setup, include=FALSE, echo=FALSE}
library(knitr)
library(rmarkdown)
library(MCMCpack)
library(ggplot2)
# library(nimble)
library(ggtern)
library(here)
knitr::opts_chunk$set(echo = FALSE, message=FALSE)

n_mcmc <- 15000
n_burn <- 15000
n_thin <- 10
n_samples <- n_mcmc / n_thin
# source(here("R", "dmixnorm.R"))
# source(here("R", "dmixmix.R"))
# source(here("R", "broken-stick.R"))
```


\doublespacing
\linenumbers

\begin{abstract}
Sedimentary deposits constitute the primary record of changing environmental conditions that have acted on Earth's surface over geologic time. Clastic sediment is eroded from source locations (parents) in sediment routing systems and deposited at sink locations (children). Both parents and children have characteristics that vary across many different dimensions, including grain size, chemical composition, and the geochronologic age of constituent detrital minerals. During transport, sediment from different parents is mixed together to form a child, which in turn may serve as the parent for other sediment further down system or later in time when buried sediment is exhumed. To the extent that parent sources produce sediment with distinguishable geochronologic ages, the distribution of detrital mineral ages observed in child sediments allows for investigation of the proportions of each parent in the child sediment which ultimately reflects properties of the sediment routing system, such as the relative sediment flux. To model the proportion of dates in a child sample that comes from each of the parent distributions, we use a Bayesian mixture of Dirichlet processes. This model allows for estimation of the mixing proportions with associated uncertainty while making minimal assumptions. We also present an extension to the model whereby we reconstruct unobserved parent distributions from multiple observed child distributions using mixtures of Dirichlet processes, accounting for uncertainty in both the number of parent distributions and the mixing proportions.
\end{abstract}

\section{Introduction}
\label{intro}

\begin{figure}
\centering\includegraphics[width=1.0\linewidth]{../figures/fig-1-cartoon2.pdf}
\caption{
Schematic depiction of a sediment routing system with an erosional source region characterized by three parents (black, red, and green) and an associated sedimentary basin (yellow). Call out plots represent the age of detrital minerals from the parents and how they are mixed to form child distributions. (a) Top-down modeling (sensu \cite{sharman2017sediment}) where one or more children are modeled as a mixture of two or more parents. (b) Bottom-up modeling where multiple children are used to reconstruct end-member sources, or parents.}
\label{fig:cartoon}
\end{figure}


To understand the origins of modern and ancient physical geography one must understand how erosional landscapes and associated sedimentary basins evolve through time \cite{romans2016environmental}. As clastic sediment is generated by weathering and erosion, it is subsequently transported downstream, mixed, and ultimately deposited into a depositional sink. Modeling sediment mixing allows inference about the processes that generated the modern landscape. The ability to decipher the relative proportions of sources that were eroded to produce sediment may thus inform understanding of the underlying geologic processes that control the evolution of the Earth's surface \cite{stock2006does,sharman2019conversion,mason2017climatic,kimbrough2015detrital}.

One of the most common ways to characterize the provenance of sediment is through detrital geochronology, dating the timing at which the individual minerals that make up a rock formed or cooled. These mineralization events typically reflect the timing of igneous rock forming events or metamorphic alteration of previously existing rocks \cite{gehrels2014detrital}. In other cases mineral ages reflect the history of mineral cooling (e.g. 'thermochronology', \cite{reiners2006using}). Detrital geochronologic ages are most commonly determined from measurements of radiogenic isotopes contained within individual mineral crystals. The decay of uranium (U) to lead (Pb) within zircon, a relatively robust mineral,  makes this approach ideally suited for tracking sedimentary mixing \cite{amidon2005u,sundell2017unmixing,sharman2017sediment}. 

In the following text, we will follow the convention that the sources of sediment are called *parents* and the sink locations are called *children*. Using this language, the manuscript aims to address two questions. First, can we estimate the proportion of each parent age distribution in a child age distribution with associated uncertainty? Second, can we estimate the marginal age distributions for unobserved parents given a set of child age distributions? These questions may be answered using "top-down" and "bottom-up" approaches to sediment unmixing, respectively (see Figure \ref{fig:cartoon}; \cite{sharman2017sediment}). The top-down approach models one or more child samples as mixtures of specified parent samples (Figure \ref{fig:cartoon}). The bottom-up approach uses multiple child samples to model likely parents which are more generally referred to as end-members in mixture modeling efforts. \cite{sharman2017sediment}. 

We present a model framework that is capable of answering the two questions above using top-down and bottom-up approaches (Figure \ref{fig:cartoon}). Bayesian mixture modeling of geochronology data, including detrital data, has numerous advantages when addressing single samples \cite{jasra2006bayesian} including allowing inference and uncertainty estimates of the number and value of true ages characterized by observed mineral dates. Here we extend this concept to consider the geologic mixing of sediments derived from source areas containing minerals recording different crystallization events. The Bayesian nonparametric statistical model presented herein has a number of advantages over previously used approaches, including being able to derive direct, probabilistic estimates of uncertainty associated with the mixture model. We demonstrate the utility of this approach using both a synthetic dataset and a well-constrained, natural case study in central California, USA \cite{sickmann2016detrital}. The top-down mixing approach is able to successfully reconstruct parent contributions in both synthetic and natural datasets. Although the bottom-up unmixing model is able to successfully reconstruct parents in the synthetic dataset, there is evidence of non-identifiability, where parents cannot be uniquely characterized from the childen data, when applied to the natural dataset. More generally, the model framework we present can also give guidance about other scientific questions that relate to mixing of non-parametric sum-to-one data in Earth sciences and other disciplines (e.g. unmixing sediment grain size distribution; \cite{weltje1997end} and references within)

\section{Model Overview}

To define the statistical model, we follow the convention that letters represent data and Greek symbols represent parameters. A plaintext symbol (y) represents a scalar, a bold lowercase symbol represents a vector ($\mathbf{y}$), and a bold uppercase symbol is a matrix ($\mathbf{Z}$) whose columns are vectors written as $\mathbf{Z} = \left( \mathbf{z}_1, \ldots, \mathbf{z}_p \right)$. We use the notation $[ y ]$ to represent the probability distribution/mass function (pdf/pmf) and let $[ y | \theta ]$ represent the conditional pdf/pmf of the random variable $y$ given $\theta$.

Following \cite{berliner2003physical}, the statistical model described below is divided into three components: the data model, the process model, and the prior model. In general, the data model defines probability distributions that describe the variability in the data due to the observation process. The data model can be modified to account for non Gaussian measurement processes like counts, outliers, spatial/temporal errors, etc \cite{tipton2017reconstruction,hefley2017bias}.  Process models describe the best scientific understanding of the process of interest. For example, process models have been used to model monthly response of trees to climate \cite{tipton2015treeRing}, the relationship between climate and pollen in sediments \cite{tipton2019predicting}, and the movement of ice sheets in Antarctica  \cite{chang2016calibrating,guan2018inferring}. The prior model describes the range of parameter values that are plausible. Sometimes the prior model is used as regularization to improve the generalization of the model to unobserved data \cite{hooten2015guide}. Following these conventions, we introduce the data models for the sediment age distributions, process models for the mixing of parents, and prior models for model selection, regularization, and mathematical completeness.

\section{Top-down mixing model}
\label{mix}
The model framework presented below, which is appropriate for situations where the parent and children sediment have been independently characterized, will answer the first research question: can one estimate the proportion of each parent that comprises the child sediment? 

\subsection{Top-down mixing data model}
\label{mix:data}
Let the $n_y$ observed age measurements of a single child of interest be $\mathbf{y}$ and let the observed date measurements for each of the $b=1, \ldots, B$ parents be given by the $n_b$-dimensional vector $\mathbf{z}_b$. Because the observed ages are measured with uncertainty reported as a dating error standard deviation, we explicitly account for this source of uncertainty in the data model. 

In the case of U-Pb dating of detrital zircon grains, dates are most commonly determined using laser ablation-inductively coupled plasma-mass spectrometry \cite{gehrels2012detrital}. Such date measurements typically have relative 2$\sigma$ analytical precision of 1-4\%, with relative uncertainty increasing for younger analyses \cite{puetz2018statistical}. 

For each detrital mineral, the estimate of dating measurement uncertainty is reported as a $n_y$-vector of standard deviations $\boldsymbol{\sigma}_{y}$ for the child and $B$ $n_b$-vectors of standard deviations $\boldsymbol{\sigma}_{z_b}$. We assume the date measurement uncertainty follows a Gaussian distribution where the observed sediment particle date is

\begin{align*}
\numberthis\label{eq:data-model}
\mathbf{y} | \tilde{\mathbf{y}}, \boldsymbol{\sigma}_y^2 & \sim \operatorname{N} (\tilde{\mathbf{y}}, \operatorname{diag} ( \boldsymbol{\sigma}_y^2 ) ), \\
\mathbf{z}_b | \tilde{\mathbf{z}}_b, \boldsymbol{\sigma}_{z_b}^2 & \sim \operatorname{N} (\tilde{\mathbf{z}}_b, \operatorname{diag} ( \boldsymbol{\sigma}_{z_b}^2 ) ).
\end{align*}

We break the variable naming convention and let $\tilde{\mathbf{y}}$ and $\tilde{\mathbf{z}}_b$ be latent parameters that represent the true, unobserved age of the sediments where $\boldsymbol{y}$ ($\boldsymbol{z}_b$) will be close to $\tilde{\mathbf{y}}$ ($\tilde{\mathbf{z}}_b$) because the dating uncertainty is small relative to the variability in the data (i.e., the average coefficient of variation of measured dates, defined as the dating standard deviation divided by the date, is about 0.02-0.03). To represent more uncertainty in the data or to account for asymmetric measurement errors a Student's-t, log-normal, or other appropriate distribution could be used instead of the normal distribution.

\subsection{Top-down mixing process model}
\label{mix:process}


The process model addresses two scientific questions: what are the estimates of the true, unobserved detrital mineral age distributions at the parent and child locations? and what proportions of those detrital minerals did each parent source contribute to the child? There are many different methods available to model the true geochronological age distributions from the sample data, including kernel density estimates \cite{vermeesch2012visualisation}, non-negative matrix factorization methods \cite{saylor2019characterizing}, and Bayesian nonparametric models of mineral fomation event mixing \cite{jasra2006bayesian,tye2019bayesian}; however, Bayesian methods have yet to be applied to the problem of sediment mixing. We develop a Bayesian nonparametric model below that approximates the geologic understanding of the data generating process.

Over geologic time, individual minerals may be repeatedly recycled into sedimentary rocks by cycles of erosion, transport, deposition, and exhumation. However in many cases the dates recorded by individual minerals contained in these deposits are distinctive and unaffected by these recycling processes (e.g., excluding burial reheating of thermochronometers \cite{fosdick2015detrital}). We assume that minerals created by the same geologic event share an age distribution that is relatively homogeneous with only small variability. Furthermore, episodes of rock and mineral formation (typically lasting $10^5$ to $10^7$ years \cite{chen1982uranium,irwin1999plutons,wotzlaw2013tracking}) are nearly discrete events relative to geologic time ($4.5 \times 10^9$ years). While minerals often show overgrowths of different ages, this provides a useful approximation. Under the conceptual model (Figure \ref{fig:cartoon}), sediment is formed by the decomposition of rocks containing minerals created at different times, and sediment at every child location is composed of an unknown number of mineral formation events that are also present at source locations.

Consider the latent, unknown age of a single mineral grain from either the child $\tilde{\mathbf{y}}_b$ or one of the $b = 1, \ldots, B$ parents $\tilde{\mathbf{z}}_b$. We assign the range of mineral ages for the $k$th formation event the base probability distribution $G(\boldsymbol{\theta}_{bk})$ which depends on parameters $\boldsymbol{\theta}_{bk}$. There are many possible choices for the base distribution $G(\boldsymbol{\theta}_{bk})$; we assume a normal distribution $N(\mu_{bk}, \sigma^2_{bk})$ with mean $\mu_{bk}$ and variance $\sigma^2_{bk}$, therefore $\boldsymbol{\theta}_{bk} = (\mu_{bk}, \sigma^2_{bk})'$. Other possible choices include a log-normal or gamma distribution that enforces a positive support on the observed age dates. Because we assume the age distribution of a single mineral formation event is relatively short with respect to geologic time, the variance parameters $\sigma^2_{bk}$ will be small relative to the age of the mineral formation event.

\begin{figure}
\begin{subfigure}[t]{0.32\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/age-mixing-model.png}
\caption{Distribution of simulated mineral formation events. Each color represents a different formation event. Notice that some formation events have wider standard deviations (i.e., resulting from longer durations of mineral formation), while other formation events are shorter.}
\label{fig:kernels}
\end{subfigure} \hfill
\begin{subfigure}[t]{0.32\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/weighted-age-mixing-model.png}
\caption{The mineral formation events from Figure \ref{fig:kernels} are re-weighted to account for relative abundance of potentially observable mineral ages provided by each parent.}
\label{fig:weighted-colored}
\end{subfigure}\hfill
\begin{subfigure}[t]{0.32\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/weighted-age-mixing-model-filled.png}
\caption{Discrete, colored formation events in the parent distribution in Figure \ref{fig:weighted-colored} are replaced by gray because the formation events are unknown. The observed data are shown as a rug plot along the y-axis.}
\label{fig:weighted}
\end{subfigure}
\caption{The mixing model over the mineral formation events. The y-axis of each plot is the age of formation and the x-axis is the probability density of the hypothetical parent distribution.}
\label{fig:clustering}
\end{figure}

In most cases the true number of mineral formation events $K$ recorded by a detrital sample is unknown. Under our model, the set of all $K$ mineral formation events is a mixture of $K$ normal distributions, as shown in Figure \ref{fig:kernels} where each mineral formation event is shown in a different color. The centers of each age distribution in Figure \ref{fig:kernels} are given by the values of $\mu_{bk}$ and the spreads of each age distribution are given by the variances $\sigma^2_{bk}$. Aerial extent, differential erosion, and the abundance of minerals of different ages within different rocks, and other factors can influence the proportion of minerals of a given age in rock at a site \cite{amidon2005construction,amidon2005u}. Figure \ref{fig:weighted-colored} shows the age distributions in Figure \ref{fig:kernels} that have been re-weighted to account for all of the factors that determine the distribution of ages in a parent source rock. We do not observe the individual mineral formation event labels ($k = 1,\ldots K$) directly, we only observe the parent age distributions after influence from the relative contributions of minerals of different formation ages (Figure \ref{fig:weighted}). Notice that in Figure \ref{fig:weighted}, the colors from Figures \ref{fig:kernels} and \ref{fig:weighted-colored} are removed, representing the fact that the mineral event labels are not observed. As a futher complication, we only observe a finite sample from the distribution in Figure \ref{fig:weighted} which is shown by the rug plot with each tick representing the observed date of each detrital mineral grain.  Thus, the number of mineral formation events is potentially challenging to extract from the data and is modeled using a Dirichlet process mixture described in Section \ref{mix:prior}. 

Consider a detrital mineral date $\tilde{z}_{ib}$ from a parent sediment source $b$ out of a set of $i = 1, \ldots, n_b$ measurements. The single sediment grain comes from a single mineral formation event implying the origin of the mineral is described by the mixture distribution

\begin{align*}
\tilde{z}_{ib} | \boldsymbol{\mu}_b, \boldsymbol{\sigma}^2_b, \gamma_{i b} & \sim \begin{cases}
\operatorname{N} \left( \tilde{z}_{ib} \middle| \mu_{1b}, \sigma_{1b}^2 \right) & \mbox{ if } \gamma_{ib} = 1 \\
\vdots & \vdots \\
\operatorname{N} \left( \tilde{z}_{ib} \middle| \mu_{Kb}, \sigma_{Kb}^2 \right) & \mbox{ if } \gamma_{ib} = K, \\
\end{cases}
\end{align*}

where $\gamma_{ib}$ is a random variable whose value acts as a label indicating which formation event $k$ the detrital mineral comes from. We define the probability of a detrital mineral coming from age of formation event $k$ as $p_{bk} \equiv P(\gamma_{ib} = k)$. Then, we write the joint distribution over all mineral grains from parent $b$ as

\begin{align*}
\tilde{\mathbf{z}}_b | \boldsymbol{\mu}_b, \boldsymbol{\sigma}^2_b, \boldsymbol{\gamma}_{b}  & \sim \prod_{i=1}^{n_b} 
\operatorname{N} \left( \tilde{z}_{ib} \middle| \mu_{1b}, \sigma_{1b}^2 \right)^{ I\{ \gamma_{ib} = 1\} } \operatorname{N} \left( \tilde{z}_{ib} \middle| \mu_{2b}, \sigma_{2b}^2 \right)^{ I\{ \gamma_{ib} = 2\} }
\cdots
\operatorname{N} \left( \tilde{z}_{ib} \middle| \mu_{Kb}, \sigma_{Kb}^2 \right)^{ I\{ \gamma_{ib} = K \} } 
\end{align*}

where $I\{ \gamma_{ib} = k\}$ is an indicator function that takes the value 1 if $\gamma_{ib} = k$ and 0 otherwise. Because there are a large number of indicator functions, we integrate them out of the process model to improve mixing and model fit. The integrated age distribution model is

\begin{align*}
\tilde{\mathbf{z}}_b | \boldsymbol{\mu}_b, \boldsymbol{\sigma}^2_b, \boldsymbol{p}_{b} & \sim \prod_{i=1}^{n_b} \sum_{k=1}^K p_{bk} \operatorname{N} \left( \tilde{z}_{ib} \middle| \mu_{kb}, \sigma^2_{kb} \right) 
\end{align*}

where $\mathbf{p}_b = (p_{b1}, \ldots, p_{bK})'$ is a mixing vector of mixing probabilities with $\sum_{k=1}^K p_{bk} = 1$. When the number of formation events $K$ is potentially infinite, the conceptual model described above can be described with a Dirichlet process. The Dirichlet process model is described in detail in Section \ref{mix:prior}.

In addition to modeling the age distribution of the parents, the process model specifies how we infer the proportion of each parent distribution in the child age distribution. We represent the mixing proportions of the $B$ parent distributions with the parameter $\boldsymbol{\phi} = (\phi_1, \ldots, \phi_B)'$, with $\sum_{b=1}^B \phi_b = 1$. The parameter $\phi_b$ is the proportion of the child distribution that comes from parent $b$. The parameter $\boldsymbol{\phi}$ accounts for differential mixing of parents. For parents that are comprised of bedrock, $\boldsymbol{\phi}$ is a function of each parent's relative aerial extent in the drainage catchment, average erosion rate, and average concentration of the detrital mineral of interest \cite{amidon2005construction}. If parents are sediment inputs (e.g., rivers), then $\boldsymbol{\phi}$ is a function of each parent’s relative sediment supply and the average concentration of the detrital mineral of interest within the sediment. 

For a single child sediment mineral date $\tilde{y}_i$ out of $i=1, \ldots, n_y$ observations, that sediment grain can only be from one parent. We define the  categorical random variable $\delta_{i}$ to represent which parent distribution the child sediment came from. Using the categorical variable, the distribution of the child sediment grain is

\begin{align*}
\tilde{y}_{i} | \boldsymbol{\mu}, \boldsymbol{\sigma}^2, \delta_i & \sim \begin{cases}
\sum_{k=1}^K p_{1k} \operatorname{N} \left( \tilde{y}_{i} \middle| \mu_{k1}, \sigma_{k1}^2 \right) & \mbox{ if } \delta_{i} = 1 \\
\vdots & \vdots \\
\sum_{k=1}^K p_{Bk} \operatorname{N} \left( \tilde{y}_{i} \middle| \mu_{kB}, \sigma_{kB}^2 \right) & \mbox{ if } \delta_{i} = B. \\
\end{cases}
\end{align*}

Then, the probability that the sediment grain came from parent $b$ is $\phi_b \equiv P(\delta_i = b)$. Defining the indicator variable $I\{ \delta_i = b\}$ where $P(\delta_i = b) = \operatorname{E} \left( I\{ \delta_i = b\} \right)$, we can write the age distribution over all sediment grains as

\begin{align*}
\tilde{\mathbf{y}}_i | \boldsymbol{\mu}, \boldsymbol{\sigma}^2, \boldsymbol{\delta} & \sim 
\prod_{i=1}^{n_y} \left( \sum_{k=1}^K p_{1k} \operatorname{N} \left( \tilde{y}_{i} \middle| \mu_{k1}, \sigma_{k1}^2 \right) \right)^{I\{\delta_{i} = 1\}}
\times
\left( \sum_{k=1}^K p_{2k} \operatorname{N} \left( \tilde{y}_{i} \middle| \mu_{k2}, \sigma_{k2}^2 \right) \right)^{I\{\delta_{i} = 2\}} \times \\
& \hspace{0.5cm} \cdots \times 
\left( \sum_{k=1}^K p_{Bk} \operatorname{N} \left( \tilde{y}_{i} \middle| \mu_{kB}, \sigma_{k}^2 \right) \right)^{I\{\delta_{i} = B\}}
\end{align*}

where, like the parent mixing model, we integrate out the component indicator variables $\boldsymbol{\delta}$. After integrating out the parent component membership indicators, the child sediment grains have the age distribution

\begin{align*}
\tilde{\mathbf{y}}_i | \boldsymbol{\mu}, \boldsymbol{\sigma}^2, \boldsymbol{\phi} & \sim  \prod_{i=1}^{n_y} \sum_{b=1}^B \phi_b \sum_{k=1}^K p_{bk} \operatorname{N} \left( \tilde{y}_i \middle| \mu_{kb}, \sigma_{kb}^2 \right),
\end{align*}

where the parameter $\phi_b = P(\delta_i = b)$ is the probability that any individual grain comes from the $b$th parent source and the posterior distribution of $\phi_b$ estimate the proportion of child sediment from parent $b$.

Combining the above results, the full process model is

\begin{align*} 
\tilde{\mathbf{y}}, \tilde{\mathbf{Z}} | \boldsymbol{\phi}, \mathbf{p}, \boldsymbol{\mu}, \boldsymbol{\sigma}^2 & \sim \left( \prod_{i=1}^{n_y} \sum_{b=1}^B \phi_b \sum_{k=1}^K p_{bk} \operatorname{N} \left( \tilde{y}_i \middle| \mu_{kb}, \sigma_{kb}^2 \right) \right) \times \\
& \hspace{0.5cm} 
\left(
\prod_{b=1}^B \prod_{j=1}^{n_b} \sum_{k=1}^K p_{bk} \operatorname{N}  \left( \tilde{z}_{jb} \middle| \mu_{kb}, \sigma_{kb}^2 \right) \right).
\end{align*}

\subsection{Top-down mixing prior model}
\label{mix:prior}

The conceptual process model assumed that we knew the number of mineral formation events $K$. In practice, the number of formation events is unknown and is a parameter to be estimated in the model. In fact, it is likely that the different parent sites will have different numbers of mineral formation events based on site-specific history. The prior model addresses the fundamental question of estimating the number of mineral formation events.

There are a number of potential approaches to model the unknown number of formation events. First, one can treat the number of formation events as a fixed parameter, perform a grid search over the different number of formation events, and choose the model that best fits the data \cite{miller2018mixture}. A second approach is to model the number of formation events using a reversible jump algorithm \cite{green1995reversible}. The third approach is to assign a Dirichlet process prior over the number of formation events. The Dirichlet process model estimates an unknown number of components without *a priori* specifying the number of components.


The Dirichlet Process is an infinite dimensional stochastic process that is a distribution over distributions \cite{ferguson1973bayesian}. We use the stick-breaking representation of a Dirichlet process 

\begin{align*}
\numberthis\label{eq:stick}
\sum_{k=1}^\infty p_{bk} G(\boldsymbol{\theta}_{bk}),
\end{align*}

where $G(\cdot)$ is the base distribution that has parameters $\boldsymbol{\theta}_{bk} = \left( \mu_{bk}, \sigma^2_{bk} \right)$' and mixing weights $p_{bk}$ with $\sum_{k=1}^\infty p_{bk} = 1$. In practice, $p_{bk} \approx 0$ for large $k$. Therefore, the infinite sum is well approximated by the finite sum $\sum_{k=1}^K p_{bk}$ for a large enough $K$ (for most problems K=10 or K=20 is sufficiently large). The stick-breaking representation for $\mathbf{p}_b$ is constructed by transforming the variables $\tilde{\mathbf{p}}_b=(\tilde{p}_{b1}, \ldots, \tilde{p}_{b K-1})'$ according to the stick-breaking representation 

\begin{align*}
p_{b k} & = \begin{cases}
\tilde{p}_{b1} & \mbox{for } k  = 1,\\
 \tilde{p}_{bk} \prod_{k'=1}^{k-1} (1 - p_{bk'}) & \mbox{for } k=2, \ldots, K-1, \\ 
1 - \prod_{k'=1}^{k-1} (1 - p_{bk'}) & \mbox{for } k  = K.
\end{cases}
\end{align*}

Priors on the $\tilde{p}_{bk}$ are assigned exchangeable $\operatorname{Beta}(1, \alpha_b)$ priors giving rise to the stick-breaking Dirichlet process model. The hyperparameters $\alpha_b$ are given exchangeable $\operatorname{Gamma}(1, 1)$ priors that control the Dirichlet process concentration (i.e. smaller $\alpha_b$ give fewer formation events, larger $\alpha_b$ give more formation events). We chose a Gaussian base measure $G(\cdot)$ with parameters $\boldsymbol{\theta}_{bk} = (\mu_{bk}, \sigma^2_{bk})'$ representing the mean and variance. Because the parent and child sites contain mineral grains derived from common formation events, we follow \cite{lock2015shared} and used shared kernels by letting $\boldsymbol{\theta}_{bk} \equiv \boldsymbol{\theta}_k = (\mu_k, \sigma^2_k)'$ for all $b=1, \ldots, B$. 

The prior on the standard deviations for the ages of formation is the truncated half-Cauchy prior $\sigma_k \sim \operatorname{Cauchy}^+(0, s)I\{0 < \sigma_k < \omega\}$, where we choose $s$ to be small relative to the range of dates observed and $\omega$ provides an upper limit to the duration of formation events. For the age distributions being modeled that span the range of 0 to about 300 Millions of years (Ma), we set s to be 25 Ma and set $\omega$ to be 50 Ma years. The truncation is important to prevent the Dirichlet process mixture from generating unrealistically long formation events which does not match our *a priori* knowledge.


The mixing parameter $\boldsymbol{\phi}$ is assigned a $\operatorname{Dirichlet}(\alpha_\phi \mathbf{1})$ prior where $\mathbf{1}$ is a vector of ones and the hyperparameter $\alpha_\phi$ is assigned a $\operatorname{Gamma}(1, 1)$ prior. When $\alpha_\phi$ is small the mixing proportions concentrate with a large probability on a single parent component, when $\alpha_\phi$ is one $\boldsymbol{\phi}$ will be uniformly distributed over all possible mixing proportions, and when $\alpha_\phi$ is large the mixing proportion will be concentrated at equal mixing proportions $\left( \frac{1}{B}, \ldots, \frac{1}{B} \right)$. 


\subsection{Top-down mixing posterior distribution}

The top-down mixing model posterior distribution is 

\begin{align*}
\numberthis\label{eq:posterior}
\left[ \boldsymbol{\phi}, \boldsymbol{\tilde{\phi}}, \boldsymbol{\mu}, \boldsymbol{\sigma}^2, \boldsymbol{b} \middle| \mathbf{y}, \mathbf{Z} \right] & \propto
\left[\mathbf{y} \middle| \mathbf{\tilde{y}}, \boldsymbol{\sigma}_y \right]
\prod_{b=1}^B \left[\mathbf{z}_b \middle| \mathbf{\tilde{z}}_b, \boldsymbol{\sigma}_b \right] \times \\
& \hspace{0.5cm} 
\left[ \mathbf{\tilde{y}} \middle| \boldsymbol{\phi}, \tilde{\boldsymbol{p}}_b, \boldsymbol{\mu}_b, \boldsymbol{\sigma}_b \right]
\prod_{b=1}^B 
\left[ \mathbf{\tilde{z}}_b \middle| \tilde{\boldsymbol{p}}_b, \boldsymbol{\mu}_b, \boldsymbol{\sigma}_b \right] \times\\
& \hspace{0.5cm} 
\left[ \boldsymbol{\phi} | \alpha_\phi \right]
\left[ \alpha_\phi \right]
\left( \prod_{b=1}^B \left[  \tilde{\boldsymbol{p}}_b \middle| \alpha_b \right]
\left[ \alpha_b \right]
\left[ \boldsymbol{\mu}_b \right]
\left[ \boldsymbol{\sigma}_b \right] \right),
\end{align*}

where the first line on the right hand side of the proportional symbol is the data model, the second line is the process model, and the third line is the prior model. We estimate the posterior using Markov Chain Monte Carlo (MCMC) using the _R_ package _NIMBLE_ \cite{nimble2017}. The model is fit using an adaptive block Metropolis-Hastings algorithm \cite{haario2001adaptive}. The constrained parameters $\tilde{\mathbf{p}}$ and $\boldsymbol{\sigma}$ are transformed to unconstrained support (logit- and log-scale transformations) for tuning the Metropolis-Hastings block proposals, with corresponding Jacobian adjustments to the acceptance probabilities. The sampling of the sum-to-one mixing proportion $\boldsymbol{\phi}$ is performed by introducing auxiliary variables $\tilde{\boldsymbol{\phi}}$. We assign a stick-breaking prior on $\tilde{\boldsymbol{\phi}}$ and sample on a logit-scale,  correcting for the transformation using the Jacobian to induce a $\operatorname{Dirichlet}(\alpha_\phi \mathbf{1})$ prior on $\boldsymbol{\phi}$.



\section{Bottom-up unmixing model}
The second research question is: can we reconstruct unobserved parent age distributions from multiple observations of children? In previous work, this analysis has been variably termed "end-member mixing analysis", "end-member modeling", or "end-member analysis" as applied to unmixing grain size or detrital age distributions \cite{sharman2017sediment,saylor2019characterizing}. The end-member unmixing analysis has two components. First, the number of parents $B$ is unknown and needs to be estimated. Second, given the number of parents $B$, what are the unobserved mineral formation age distributions for the $B$ parents? For this paper, we assume the number of parents $B$ is known. There are a number of criteria for selecting the number of parents including using Bayesian information criteria, reversible jump MCMC \cite{jasra2006bayesian}, assuming a Dirichlet process over the number of parents, or fitting a mixture of finite mixtures \cite{miller2018mixture}. Rather than explore these ideas, we devote our effort on developing the unmixing model for a fixed number of parents \cite{miller2018mixture}. The end-member analysis model uses the same general framework presented in the mixture of Gaussians model (\ref{eq:posterior}) with some modifications. 

\subsection{Bottom-up unmxing data model}

Let $d=1, \ldots, D$ index the $D$ child sediments that are each composed of $i=1, \ldots, n_d$ samples. As before, we assume a Gaussian dating error distribution for child $d$ given by 

\begin{align*}
\mathbf{y}_d | \tilde{\mathbf{y}}_d, \boldsymbol{\sigma}^2_d \sim \operatorname{N}(\tilde{\mathbf{y}}_{d}, \operatorname{diag} ( \boldsymbol{\sigma}^2_{d}) ),
\end{align*}

where $\mathbf{\tilde{y}}_{d}$ is the true, unobserved $n_d$-vector of sediment dates and $\boldsymbol{\sigma}_{d}$ is a $n_d$-vector of dating uncertainty standard deviations.

Unlike in the top-down mixing model above, none of the parent $\mathbf{z}$s are observed in the bottom-up unmixing model. Hence, the parent distributions are estimated entirely using child sediment observations. The end-member process model for a fixed given number of parents $B$ is 

\begin{align}
\label{eq:unmix}
\tilde{y}_{id} | \boldsymbol{\phi}_d, \boldsymbol{p}, \boldsymbol{\mu}, \boldsymbol{\sigma^2} \\
& = \boldsymbol{\phi}_d \sum_{b=1}^B \sum_{k=1}^K p_{bk} \operatorname{N}(\mu_{k}, \sigma^2_{k}),
\end{align}

where, like before, we assume a Gaussian mixing distribution using shared kernels across the $B$ parents. Like the top-down mixing model, these equations can be derived by introducing categorical random variables then marginalizing out the latent indicator variables from the model. The $b$th unknown parent age distribution is $\sum_{k=1}^K p_{bk} \operatorname{N}(\mu_{k}, \sigma^2_{k})$ and the posterior estimate $\phi_{bd}$ is the proportion of child $d$ that comes from parent $b$. The prior model for the bottom-up unmixing model is the same as for the top-down mixing model, except for the dimension of different variables.


\subsection{Bottom-up unmixing posterior distribution}
The posterior distribution that we estimate with the end member unmixing model is 

\begin{align*}
\numberthis\label{eq:posterior-unmix}
\left[ \boldsymbol{\phi}_1, \ldots, \boldsymbol{\phi}_D, \boldsymbol{\mu}, \boldsymbol{\sigma}^2, \boldsymbol{p} \middle| \mathbf{Y} \right] & \propto 
\prod_{d=1}^D \left[\mathbf{y}_d \middle| \mathbf{\tilde{y}}_d, \boldsymbol{\sigma}_{d} \right] \times \\
& \hspace{0.5cm} 
\prod_{d=1}^D \left[ \tilde{\mathbf{y}}_d \middle| \boldsymbol{\phi}_d, \tilde{\boldsymbol{p}}_d, \boldsymbol{\mu}, \boldsymbol{\sigma} \right] \times \\
& \hspace{0.5cm} 
\left( \prod_{d=1}^D \left[ \boldsymbol{\phi}_d | \alpha_{\phi d} \right]
\left[ \alpha_{\phi d} \right] \right)
\left( \prod_{d=1}^D \left[  \tilde{\boldsymbol{p}}_b \middle| \alpha_b \right]
\left[ \alpha_b \right]
\left[ \boldsymbol{\mu}_b \right]
\left[ \boldsymbol{\sigma}_b \right] \right),
\end{align*}

where the priors and MCMC algorithm are the same as those in (\ref{eq:posterior}) except for a change in dimensionality. Code and data for replication of results presented in this manuscript can be found at [https://github.com/jtipton25/mixing-manuscript](https://github.com/jtipton25/mixing-manuscript).



\section{Simulation of synthetic detrital age distributions}


\begin{figure}
\begin{subfigure}[t]{0.49\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/sim-density-nimble.png}
% \centering\includegraphics[width=0.95\linewidth]{../figures/sim-joint-hand-shared-age.png}
\caption{Ternary plot showing posterior mixing proportion estimates as black circles and the simulated true mixing proportions as an orange triangle.}
\label{fig:simulation2}
\end{subfigure} \hfill
\begin{subfigure}[t]{0.49\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/fit-mix-cdf-sim-nimble.png}
% \centering\includegraphics[width=0.95\linewidth]{../figures/fit-mix-cdf-sim.png}
\caption{Plot of simulated parents with fitted posterior CDF estimates in red and the simulated true CDF in black. Each red line represents a posterior sample of the cumulative parent age density. }
\label{fig:simulation3}
\end{subfigure} 
\caption{Simulation study results for the top-down mixture modeling approach.}
\label{fig:simulation}
\end{figure}

We explore the performance of the model using a simulation of synthetic detrital age distributions. The aim of the simulation study is to understand how the model performs using realistic data and verify the model is capable of recovering the simulated parameters. The simulation study framework can also be used to understand how uncertainty in estimation varies with respect to sample size, variability in the data, and other questions of interest. 

First, we create synthetic data using the mixing model in (\ref{eq:posterior}) for $B=3$ parents and a single child. The parent distributions were composed of 200, 250, and 150 simulated grain dates, respectively, and the child distribution was composed of 150 grain dates. In simulation, we used age dating uncertainties ($\boldsymbol{\sigma}_y, \boldsymbol{\sigma}_z$) that were about 1-3\% of the total range of the age distribution. These are similar to measurement uncertainties in the data and demonstrate the model is capable of accounting for measurement errors. <!-- Other parameter settings and code for the simulation study is in Appendix. -->

The posterior mixing proportion estimates $\boldsymbol{\phi}$ in Figure \ref{fig:simulation2} are are plotted as black dots, a smoothed density shaded in blue \cite{ggtern}, and the simulated mixing proportion as an orange triangle, demonstrating that the model is accurately estimating the simulated true mixing proportion. Figure \ref{fig:simulation3} shows the estimated CDFs with posterior samples in red and the simulated CDF in black. The results shown in Figure \ref{fig:simulation} demonstrate that the model is accurately estimating the simulated mixing proportions $\boldsymbol{\phi}$ as well as the parent age distributions. These results validate the effectiveness of the top-down mixing model to recover simulated parameters of interest given simulated data.


\begin{figure}
\begin{subfigure}[t]{0.49\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/fit-unmix-daughters-sim-nimble.png}
% \centering\includegraphics[width=0.95\linewidth]{../figures/fit-unmix-daughters-sim.png}
\caption{Posterior estimates of mixing proportions for 4 of the 20 children from the unmixing model shown. The posterior samples are black circles and the simulated true mixing proportions are shown as orange triangles.}
\label{fig:sim-unmix2}
\end{subfigure}\hfill
\begin{subfigure}[t]{0.49\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/fit-unmix-cdf-sim-nimble.png}
% \centering\includegraphics[width=0.95\linewidth]{../figures/fit-unmix-cdf-sim.png}
\caption{Posterior estimates of the unobserved parent cumulative distribution functions in red. The simulated parent CDF is shown in black.}
\label{fig:sim-unmix3}
\end{subfigure}
\caption{Simulation study results for the bottom-up, end-member unmixing model. The bottom-up mixing model does a good job of estimating the true, unobserved parent age cumulative distribution functions despite the model not using any of the parent data.}
\label{fig:sim-unmix}
\end{figure}

We also simulated data from the bottom-up, end-member unmixing model to test how well the proposed framework can reconstruct unobserved parent distributions (assuming the number of parents is known, see Figure \ref{fig:cartoon}b). For the simulation, we used $B=3$ parents and $D=20$ children where each child consisted of 250 measured sediment grain dates following the model in (\ref{eq:posterior-unmix}). The dating uncertainties ($\boldsymbol{\sigma}_y$) were set at about 2.5\% of the total range of the age distribution.

Using simulated data, the model is able to reconstruct unobserved parent age distributions. Figure \ref{fig:sim-unmix2} shows the posterior samples for the mixing proportion of each child as black dots with the simulated mixing proportion plotted using an orange triangle. In general, the model can recover the mixing proportions in this simulation example with high precision.Even  though the model uses none of the data from the parents, the end-member unmixing model produces reasonable end-member parent age distribution estimates. Figure \ref{fig:sim-unmix3} shows the estimated cumulative distribution function produced by the end-member unmixing model which shows the bottom-up unmixing model is capturing the unobserved parent distributions. However, and not surprisingly, the accuracy for the bottom-up unmixing model is not as good as the fit that uses observations from the parent distribution (i.e. the top-down mixture model) as can be seen in the slightly larger uncertainty estimates of the CDF. 


A large overlap in the distribution of parent ages is a feature that occurs, particularly in detrital zircon geochronology studies.  The preservation of zircons through multiple cycles of erosion and re-sedimentation means that overlapping zircon ages will be present in many rocks, for example the preponderance of Grenville zircons in a host of sedimentary formations of varying age. For parent age distributions that are quite similar to one another, the reconstruction of the unknown parent distributions suffers from weak identifiability. In these situations, the estimated parents jointly contain all of the correct formation events, but the model is unable to attribute the formation events to the correct parents. In other words, while the model identifies the correct age components, the model sometimes struggles to correctly group these components into the correct parent distributions. This is not an unexpected result because Bayesian nonparametric models are well understood to suffer from non-identifiability issues in the context of the Bayesian nonparametric framework \cite{ferguson1983bayesian,diebolt1994estimation,richardson1997bayesian,fruhwirth2006finite}. Non-identifiability is not a weakness of the particular proposed model framework; the non-identifiability applies to end-member unmixing models in general \cite{weltje2007genetically}. To overcome the non-identifiability, a potential solution is to impose constraints on the end-members and initialization conditions \cite{donoho2004does,miao2007endmember,chen2012hals}. Therefore, any end-member unmixing model that uses only child age distributions will have issues in accurately reconstructing the parent distributions if the assumption of the constraints is not met (i.e. the parent age distributions are structurally similar). 


Bottom-up unmixing models provide a useful way to explore large detrital datasets with unknown sedimentary sources. Providing a way to identify those datasets that either are or are not susceptible to non-identifiability, and thus not amenable to bottom-up unmixing, is critical to success. An advantage of our framework is the end-member unmixing model produces uncertainty estimates that are larger when the model is weakly identifiable. Thus, the uncertainty intervals can be used as a diagnostic to check for identifiability.


\section{Model Application to a Natural Case Study}

\begin{figure}
\centering
%```{r, echo = FALSE, out.width = "0.95\\linewidth", fig.align = "center"}
%  knitr::include_graphics(here::here("figures", "parents-data-age.png"))
%```
\includegraphics[width=0.95\linewidth]{../figures/all-data.png}
\caption{The sediment age data used for the mixing and unmixing models. The three parent age distributions are shown in the top plot and the 12 child age distributions are shown in the bottom plot. The $x$-axes reprensent the measured age in 100 Ma and the $y$-axes shows the empirical density.}
\label{fig:parents-data}
\end{figure}

We apply the model presented here to a well-constrained modern dataset from the central California coast \cite{sickmann2016detrital} shown in Figure \ref{fig:parents-data} where we focus on sediments dating to the most recent 300 Ma. Following the same mixing framework presented in \cite{sharman2017sediment}, there are five samples (river and beach sediment) used to characterize three distinct sediment inputs (parents) to the region, each with a distinct detrital age distribution (Figure \ref{fig:parents-data}). Parents 1 and 2 (P1 and P2) are comprised of river samples (CAR and SAR, respectively) that represent sediment sources along the Big Sur coastline and Salinas River drainage, respectively. Parent 3 (P3) is comprised of two river samples (SNR and PAR) and one beach sample (ANB) that represent northern sediment sources in the Santa Cruz Mountains and western Diablo Range \cite{sickmann2016detrital,sharman2017sediment}. Twelve child samples (beach and submarine canyon sediment) are used to characterize how these parents are mixed in littoral and marine environments. In total, this dataset (Figure \ref{fig:map}) consists of 4,026 individual detrital zircon  U-Pb analyses, with individual samples having 82 to 316 analyses each (median of 290 analyses per sample) \cite{sickmann2016detrital}.

\begin{figure}
\centering
\includegraphics[width=0.85\linewidth]{../figures/California-study-area.pdf}
\caption{Locations of the parents and children data for the study region in California, USA.}
\label{fig:map}
\end{figure}

\begin{figure}
\begin{subfigure}[t]{0.49\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/mixing-density-nimble.png}
% \centering\includegraphics[width=0.95\linewidth]{../figures/mixing-density.png}
\caption{Ternary plot showing posterior predictive density estimates of mixing proportions. Each dot represents one of 500 MCMC samples. The black shading is proportional to the estimated posterior probability density.}
%, and the red dot shows the posterior mean estimate.}
\label{fig:ternary}
\end{subfigure}\hfill
\begin{subfigure}[t]{0.49\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/fit-mix-cdf-data-nimble.png}
% \centering\includegraphics[width=0.95\linewidth]{../figures/fit-mix-cdf-data.png}
\caption{Posterior estimates of the parent and child CDFs shown in red. The empirical CDFs calculated from the raw data are shown in black.}
\label{fig:mixing-cdf-data}
\end{subfigure}
\caption{Results from the top-down mixing applied to sample T693 show that the mixing model is able to accurately reconstruct the parent and child distributions and produce estimates of the mixing proportions with associated uncertainty.}
\label{fig:mixing-density}
\end{figure}

We first examine the top-down mixture model (Figure \ref{fig:cartoon}a). Figure \ref{fig:ternary} shows the reconstruction of the mixing proportions for a sample from a submarine canyon (T693) modeled as a mixture of the three specified parent distributions (P1-P3). Visual inspection of the histograms of the data (Figure \ref{fig:parents-data}) would suggest that this child sample is a mixture composed mostly of P3 (a combination of the samples ANB, SNR, and PAR). The posterior estimates of the mixing proportion of each parent for child T693 confirms that the primary component of the mixture is from the P3 (Figure \ref{fig:ternary}). Figure \ref{fig:mixing-cdf-data} shows the model is capturing the basic patterns in the parent CDFs as the estimated CDFs are very close to the empirical CDFs for the parents. 

\begin{figure}
\begin{subfigure}[t]{0.49\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/fit-unmix-daughters-data-nimble.png}
% \centering\includegraphics[width=0.95\linewidth]{../figures/fit-unmix-daughters-data.png}
\caption{Posterior estimates for the mixing proportions of each parent for four child sediments. Notice that without observing the parents, the posterior distribution of mixing proportions for child T693 is generally similar to the top-down mixing model in Figure \ref{fig:ternary} but has a slightly different shape.}
\label{fig:unmixing-daughter-data}
\end{subfigure}\hfill
\begin{subfigure}[t]{0.49\textwidth}
\centering\includegraphics[width=0.95\linewidth]{../figures/fit-unmix-cdf-data-nimble.png}
% \centering\includegraphics[width=0.95\linewidth]{../figures/fit-unmix-cdf-data.png}
\caption{Posterior estimates for the unobserved parent cumulative distribution functions shown in red over 0-300 Ma. The black lines show the empirical cumulative distribution functions.}
\label{fig:unmixing-cdf-data}
\end{subfigure}
\caption{Results of end-member unmixing model fit to real data. The figures show that the end-member unmixing model is estimating the parameters of interest, but with some inaccuracies due to a lack of identifiability.}
\end{figure}


Application of the bottom-up, end-member unmixing model to the data set in \cite{sickmann2016detrital} results in non-identifiability issues as the simulated age distributions as evidenced by the larger posterior uncertainty in Figure \ref{fig:unmixing-cdf-data}. Posterior probability estimates are obtained for the proportion of each child that comes from the modeled end-member (Figure \ref{fig:unmixing-daughter-data}), but based on the differences in estimates from the bottom-up mixing model estimates, the distributions should be interpreted cautiously. Some of these differences are due to the fact that some children are nearly "pure" representations of a parent (e.g. GSB is nearly a "pure" child of P1). As more and more children are included, especially those that are close to "pure" types, they provide a soft constraint on the identifiability problem. The estimated CDFs shown in red in Figure \ref{fig:unmixing-cdf-data} with the empirical CDFs from the parent data shown in black suggest that the unmixing model is performing well despite the fact that the model is unaware of the parent data although there is much unertainty about the CDF for P2, likely due to the similarity in distribution to P1 (Figure \ref{fig:parents-data}). 



\section{Conclusion}

Starting from a conceptual model of how sediments mix over a landscape, we developed a generative Bayesian nonparametric statistical model for detrital mineral age data. This model allows us to characterize the uncertainty we have in age distributions of parents and children and the mixing coefficients, accounting for the uncertainties in measured dates \cite{tye2019bayesian}. The statistical models proposed can be understood as abstractions to the mixing of sediments on the landscape while also estimating probabilistic uncertainty in the distribution estimates. Because the model can simulate sediment age distributions, we can directly explore the assumptions of the model by simulating synthetic data. Running a simulation experiment demonstrated the model is capable of recovering simulated distributions supporting the usefulness of the models when applied to the observed data. 

We proposed two frameworks to model the sediment mixing mechanisms: the top-down mixing model where mineral dates are measured for both parent and child sediments and a bottom-up unmixing framework where mineral dates are only measured for the children. The top-down model estimated the parent and child distributions and the mixing propotions with high precision and accuracy. The bottom-up model ocassionally demonstrated evidence of non-identifiability, suggesting the inference for the bottom-up model is less precise than for the top-down mixing model; however, the variances of these estimates are larger in our bottom-up unmixing model, recognizing the challenges in reconstructing unobserved parent age distributions. 


Applying the proposed methods to central California coast data in \cite{sickmann2016detrital}, we produced estimates of the mixing proportions of child sediments under both the mixing and unmixing models. Other studies have produced similar estimates \cite{amidon2005construction,amidon2005u}; our contribution is the mechanistic model framework that produces estimates of mixing with associated uncertainty. We account for dating uncertainty directly in the model and by modifying the model statement to remove dating uncertainty (i.e., removing the data models in Eq. (\ref{eq:data-model})) we can examine the effects on inference by not accounting for the dating uncertainty.


Direct, probabilistic estimates of uncertainty and the ability to calculate derived quantities with uncertainty is a benefit of the Bayesian methodology. Thus, we can answer questions like what is the probability that at least 50\% of child sediment T693 comes from parent P3? The answer is calculated directly from the posterior samples using the Monte Carlo approximation $\frac{1}{L} \sum_{\ell=1}^L I\{ \phi_{\mbox{P3}}^{(\ell)} \geq 0.5\} = 0.672$, where $\ell=1, \ldots, L$ are the indices of the MCMC samples and $\phi_{\mbox{P3}}^{(\ell)}$ is the estimated mixing proportion for the $\ell$th MCMC iteration. The probability that at least 50\% of the child sediment comes from parent P3 and at least 25\% comes from parent P2 is  $\frac{1}{L} \sum_{\ell=1}^L I\{ \phi_{\mbox{P3}} \geq 0.5 \} \times I\{ \phi_{\mbox{P2}} \geq 0.25 \}= 0.283$. Because the model produces a posterior probability, any such probabilistic questions can be calculated as derived quantities. For example, the Bayesian model framework we introduce can be used to ask questions like: what proportion of a given sample contains grains older than a given age? or what is the probability that an unobserved parent contains grains with a particular age range. Once the posterior samples have been calculated, any such questions about derived quantities are answerable using posterior samples.

In addition, the ability to include prior information in the Bayesian framework is a useful tool that can be used to improve estimation and test geologic hypotheses. For example, certain geologic events, such as the Grenville orogeny, produced large amounts of zircon that have since been broadly dispersed and recycled in sedimentary rocks. Priors that account for the likelihood of observing zircons of Grenville-age (or other known zircon-producing events) can be introduced into this model framework to improve model performance. In addition, our framework can accommodate a variety of detrital data with different magnitudes of uncertainty. As analytic techniques for dating minerals improve, it is important to account for dating uncertainties that might have orders of magnitude difference making our method more robust to future improvements in analytic laboratory techniques.



\section{Acknowledgements}

Support for SAJ came from the FEDMAP component of the US Geological Survey National Cooperative Geologic Mapping Program. This draft manuscript is distributed solely for purposes of scientific peer review. Its content is deliberative and predecisional, so it must not be disclosed or released by reviewers. Because the manuscript has not yet been approved for publication by the U.S. Geological Survey (USGS), it does not represent any official USGS finding or policy.  Any use of trade, firm, or product names is for descriptive purposes only and does not imply endorsement by the U.S. Government.




